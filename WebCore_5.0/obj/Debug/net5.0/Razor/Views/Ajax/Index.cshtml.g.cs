#pragma checksum "D:\Users\MIKOLKA\PV911\WebCore_5.0\Views\Ajax\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "36cee4c8694d3c499b7c613094489f5184b44623"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Ajax_Index), @"mvc.1.0.view", @"/Views/Ajax/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\Users\MIKOLKA\PV911\WebCore_5.0\Views\_ViewImports.cshtml"
using WebCore_5._0;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Users\MIKOLKA\PV911\WebCore_5.0\Views\_ViewImports.cshtml"
using WebCore_5._0.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"36cee4c8694d3c499b7c613094489f5184b44623", @"/Views/Ajax/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"02bd8a2945abe5ec302fce3c79b04fefeb312879", @"/Views/_ViewImports.cshtml")]
    public class Views_Ajax_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 1 "D:\Users\MIKOLKA\PV911\WebCore_5.0\Views\Ajax\Index.cshtml"
  
    ViewData["Title"] = "Ajax Page";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<div class=""text-center"">
    <h1 class=""display-4"">Welcome AJAX</h1>

</div>

<div style=""display:flex; justify-content: space-between; align-items:center"">
    <div>
        <h3>Teachers</h3>
        <section id=""mainTeachers"">
            Load...
        </section>

        <section id=""newTeacher"">
            <input type=""text"" id=""newTeacherName"" />
            <input type=""button"" id=""btnCreate"" value=""Create"" />
        </section>
    </div>
    <div>
        <h3>Groups</h3>
        <section id=""mainGroups"">
            Load...
        </section>
        <section id=""newGroup"">
            <input type=""text"" id=""newGroupName"" />
            <select id=""newTeacherG""></select>
            <input type=""button"" id=""btnCreateG"" value=""Create"" />
        </section>
    </div>
    <div>
        <h3>Students</h3>
        <section id=""mainStudents"">
            Load...
        </section>
        <section id=""newStudent"">
            <input type=""text"" id=""newStudentName"" />");
            WriteLiteral(@"
            <input type=""button"" id=""btnCreateS"" value=""Create"" />
        </section>
    </div>
</div>


<script>
    //Teachers
    function serverResponseAddTeacher(res) {
        console.log(res);
        fetchGetTeachers();
    }

    document.getElementById(""btnCreate"").onclick = function () {
        let newTeacher = {
            id: 0,
            name: document.getElementById(""newTeacherName"").value
        };

        fetch(""/api/Teachers"", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: JSON.stringify(newTeacher)
        })
            .then(response => response.json()) // Преобразуем ответ в json
            .then(json => serverResponseAddTeacher(json))
            .catch((ex) => { // обрабатываем возможную ошибку
                console.log(""Error: "" + ex.message);
                console.log(""Response: "" ");
            WriteLiteral(@"+ ex.response);
            });
        document.getElementById(""newTeacherName"").value = """";

    }

    // Построение страницы по результатам ответа от сервера
    function renderTeachersList(json) {
        console.log(""Get From Server: "");
        console.log(json);

        //Очищаем mainTeachers
        let mainTeachers = document.getElementById(""mainTeachers"");
        mainTeachers.innerHTML = """";

        //Создаем ul
        let ul = document.createElement(""ul"")

        //Создаем коллекцию элементов li и внедрю ее в ul
        for (var i = 0; i < json.length; i++) {
            let li = document.createElement(""li"");
            li.innerText = json[i].name;
            li.className = json[i].id;
            li.ondblclick = function () {
                let id = this.className;
                let name = this.innerText;
                this.innerHTML = """";

                //Поле id
                let inId = document.createElement(""input"");
                inId.type = ""h");
            WriteLiteral(@"idden"";
                inId.id = ""editNowId"";
                inId.value = id;
                this.appendChild(inId);

                //Поле name
                let inName = document.createElement(""input"");
                inName.type = ""text"";
                inName.id = ""editNowName"";
                inName.value = name;
                this.appendChild(inName);

                //Кнопка Save
                let btnSave = document.createElement(""input"");
                btnSave.type = ""button"";
                btnSave.value = ""Save"";
                btnSave.onclick = function () {
                    let id = document.getElementById(""editNowId"").value;
                    let name = document.getElementById(""editNowName"").value;

                    fetch(""/api/Teachers/"" + id, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                            // 'Content-Type': 'application/x-www-f");
            WriteLiteral(@"orm-urlencoded',
                        },
                        body: JSON.stringify({
                            id: id,
                            name: name
                        })

                    })
                        .then(fetchGetTeachers)
                        .catch((ex) => { // обрабатываем возможную ошибку
                            console.log(""Error: "" + ex.message);
                            console.log(""Response: "" + ex.response);
                        });
                }
                this.appendChild(btnSave);

                let btnCancel = document.createElement(""input"");
                btnCancel.type = ""button"";
                btnCancel.value = ""Cancel""
                btnCancel.onclick = function () {
                    fetchGetTeachers();
                }
                this.appendChild(btnCancel);
            }
            let span = document.createElement(""span"");
            let a = document.createElement(""a"");
            a");
            WriteLiteral(@".href = ""#"";
            a.innerText = "" del "";
            a.style.color = ""red"";
            a.className = json[i].id;
            a.onclick = function () {
                fetch(""/api/Teachers/"" + this.className, {
                    method: 'DELETE'
                })
                    .then(fetchGetTeachers) // Преобразуем ответ в json
                    .catch((ex) => { // обрабатываем возможную ошибку
                        console.log(""Error: "" + ex.message);
                        console.log(""Response: "" + ex.response);
                    });
            }
            span.appendChild(a);
            li.appendChild(span);
            ul.appendChild(li);
        }

        //Внедряю коллекцию в нужный section
        mainTeachers.appendChild(ul);
    }

    // Выполнение запроса к серверу
    function fetchGetTeachers() {
        fetch(""/api/Teachers"") // Пошлем запрос GET (по умолчанию) по марштуру на сервер
            .then(response => response.json()) // Преобразу");
            WriteLiteral(@"ем ответ в json
            .then(json => renderTeachersList(json)) // Передадим данные в метод
            .catch((ex) => { // обрабатываем возможную ошибку
                console.log(""Error: "" + ex.message);
                console.log(""Response: "" + ex.response);
            });
    }

    fetchGetTeachers();

</script>

<script>
    //Groups
    function serverResponseAddGroup(res) {
        console.log(res);
        fetchGetGroups();
    }

    document.getElementById(""btnCreateG"").onclick = function () {
        let newGroup = {
            id: 0,
            name: document.getElementById(""newGroupName"").value
        };

        fetch(""/api/Groupps"", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: JSON.stringify(newGroup)
        })
            .then(response => response.json()) // Преобразуем ответ в json
   ");
            WriteLiteral(@"         .then(json => serverResponseAddGroup(json))
            .catch((ex) => { // обрабатываем возможную ошибку
                console.log(""Error: "" + ex.message);
                console.log(""Response: "" + ex.response);
            });
        document.getElementById(""newGroupName"").value = """";

    }

    function renderGroupsList(json) {
        console.log(""Get From Server: "");
        console.log(json);

        //Очищаем mainGroups
        let mainGroups = document.getElementById(""mainGroups"");
        mainGroups.innerHTML = """";

        //Создаем ul
        let ul = document.createElement(""ul"")
        let selectT = document.getElementById(""newTeacherG"");
        let teachers;

        //Создаем коллекцию элементов li и внедрю ее в ul
        for (var i = 0; i < json.length; i++) {
            let li = document.createElement(""li"");
            teachers = json[0].teachers;
            li.innerText = json[i].name;
            li.className = json[i].id;
            li.ondbl");
            WriteLiteral(@"click = function () {
                let id = this.className;
                let name = this.innerText;
                this.innerHTML = """";

                //Поле id
                let inId = document.createElement(""input"");
                inId.type = ""hidden"";
                inId.id = ""editNowIdG"";
                inId.value = id;
                this.appendChild(inId);

                //Поле name
                let inName = document.createElement(""input"");
                inName.type = ""text"";
                inName.id = ""editNowNameG"";
                inName.value = name;
                this.appendChild(inName);

                //Кнопка Save
                let btnSave = document.createElement(""input"");
                btnSave.type = ""button"";
                btnSave.value = ""Save"";
                btnSave.onclick = function () {
                    let id = document.getElementById(""editNowIdG"").value;
                    let name = document.getElementById(""editNowNameG""");
            WriteLiteral(@").value;

                    fetch(""/api/Groupps/"" + id, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                            // 'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: JSON.stringify({
                            id: id,
                            name: name
                        })

                    })
                        .then(fetchGetGroups)
                        .catch((ex) => { // обрабатываем возможную ошибку
                            console.log(""Error: "" + ex.message);
                            console.log(""Response: "" + ex.response);
                        });
                }
                this.appendChild(btnSave);

                let btnCancel = document.createElement(""input"");
                btnCancel.type = ""button"";
                btnCancel.value = ""Cancel""
                btnCanc");
            WriteLiteral(@"el.onclick = function () {
                    fetchGetGroups();
                }
                this.appendChild(btnCancel);
            }
            let spanT = document.createElement(""span"");
            spanT.innerText = ""  ("" + json[i].teacher + "")"";
            spanT.style.color = ""green"";
            let span = document.createElement(""span"");
            let a = document.createElement(""a"");
            a.href = ""#"";
            a.innerText = "" del"";
            a.style.color = ""red"";
            a.className = json[i].id;
            a.onclick = function () {
                fetch(""/api/Groupps/"" + this.className, {
                    method: 'DELETE'
                })
                    .then(fetchGetGroups) // Преобразуем ответ в json
                    .catch((ex) => { // обрабатываем возможную ошибку
                        console.log(""Error: "" + ex.message);
                        console.log(""Response: "" + ex.response);
                    });
            }
       ");
            WriteLiteral(@"     span.appendChild(a);
            li.appendChild(spanT);
            li.appendChild(span);
            ul.appendChild(li);
        }

        //Заполняю список доступных учителей

        for (var i = 0; i < teachers.length; i++) {
            let option = document.createElement(""option"");
            option.value = teachers[i].id;
            option.text = teachers[i].name;
            selectT.appendChild(option);
        }
        let sel = selectT.getElementsByTagName('option');
        sel[0].selected = true;

        //Внедряю коллекцию в нужный section
        mainGroups.appendChild(ul);

    }

    // Выполнение запроса к серверу
    function fetchGetGroups() {
        fetch(""/api/Groupps"") // Пошлем запрос GET (по умолчанию) по марштуру на сервер
            .then(response => response.json()) // Преобразуем ответ в json
            .then(json => renderGroupsList(json)) // Передадим данные в метод
            .catch((ex) => { // обрабатываем возможную ошибку
            ");
            WriteLiteral("    console.log(\"Error: \" + ex.message);\r\n                console.log(\"Response: \" + ex.response);\r\n            });\r\n    }\r\n\r\n    fetchGetGroups();\r\n\r\n</script>\r\n\r\n<script>\r\n    //Students\r\n</script>\r\n");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
